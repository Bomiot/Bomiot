import{Q as M}from"./QPage-Cbwj6EO4.js";import{u as R}from"./use-meta-T7rPjses.js";import{u as z}from"./use-quasar-f8m-PZpx.js";import{u as W,Q as k}from"./QItemLabel-DDMdkE6q.js";import{a as $,r,o as L,w as S,a2 as x,a3 as G,a6 as o,a7 as l,J as _,a9 as p,a5 as i,a8 as v,ad as c,a4 as h,aw as E,aJ as J,ai as K,ar as H,e as X,ab as Y}from"./index-DC_W_xoa.js";import{a as Z,b as ee}from"./rtl-BeMP6JtA.js";import{Q as te,a as ae,b as ne}from"./QTable-DCz45Q1T.js";import{e as oe,g as se,p as w}from"./axios-2C-KJX3t.js";import{u as ie}from"./language-h3alFOcN.js";import{u as le}from"./vue-i18n.runtime-CWmhyg6E.js";const re={class:"q-pa-md"},de={key:0},ue={key:1},ce={__name:"TableList",setup(T){const{t}=le(),n=z(),d=W(),P=ie(),C=$(()=>[{name:"username",required:!0,label:t("username"),align:"left",field:"username"},{name:"email",align:"center",label:t("email"),field:"email"},{name:"date_joined",label:t("date_joined"),field:"date_joined"},{name:"last_login",label:t("last_login"),field:"last_login"},{name:"updated_time",label:t("updated_time"),field:"updated_time",sortable:!0},{name:"action",label:t("action"),align:"right"}]),y=$(()=>d.token),m=r([]),U=r([]),b=r(""),Q=r(0),g=r({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),V=$(()=>y.value!==""?Math.ceil(Q.value/g.value.rowsPerPage):0),q=r(n.screen.height*.73+"px"),A=r(n.screen.width*.825+"px"),B=r(n.dark.isActive?"#121212":"#ffffff");function u(s){let e={};s?e=s:e.pagination=g.value,d.userPermissionGet("Get User List")&&(se({url:"core/user/",params:{search:b.value,ordering:(g.value.descending?"-":"")+g.value.sortBy,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(a=>{a.login||(m.value=a.results,Q.value=a.count,U.value=a.permission)}).catch(a=>(n.loading.hide(),Promise.reject(a))),g.value=e.pagination)}function D(){n.dialog({dark:n.dark.isActive,title:t("newUser"),message:t("createuser"),prompt:{model:"",isValid:s=>s.length>2,type:"text"},cancel:!0}).onOk(s=>{w("core/user/create/",{username:s}).then(()=>{u()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})})}function O(s){n.dialog({dark:n.dark.isActive,title:t("changepassword"),message:t("changePWD"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(e=>{w("core/user/changepwd/",{id:m.value[s].id,pwd:e}).then(()=>{}).catch(a=>{n.notify({type:"error",message:a}),n.loading.hide()})})}function j(s){n.dialog({title:t("permission"),message:t("choosepermission"),options:{type:"checkbox",model:Object.keys(m.value[s].permission),inline:!0,items:U.value},cancel:!0}).onOk(e=>{w("core/user/setpermission/",{id:m.value[s].id,permission:e}).then(()=>{u()}).catch(a=>{n.notify({type:"error",message:a}),n.loading.hide()})})}function I(s){w("core/user/lock/",{id:m.value[s].id}).then(()=>{u()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})}function N(s){n.dialog({dark:n.dark.isActive,title:t("deleteuser"),message:t("confirmnotice"),cancel:!0}).onOk(()=>{w("core/user/delete/",{id:m.value[s].id}).then(()=>{u()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})})}L(()=>{F(),u()}),S(()=>n.dark.isActive,s=>{B.value=s?"#121212":"#ffffff"});function F(){oe.on("needLogin",s=>{s&&(m.value=[],U.value=[],b.value="",Q.value=0)})}return S(()=>P.langData,s=>{s&&u()}),(s,e)=>(x(),G("div",re,[o(ne,{class:H(i(n).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:m.value,columns:C.value,"row-key":"index",pagination:g.value,"onUpdate:pagination":e[7]||(e[7]=a=>g.value=a),separator:"cell","no-data-label":i(t)("nodata"),"rows-per-page-label":i(t)("per_page"),"rows-per-page-options":[10,30,50,200,1e3],"table-style":{height:q.value,width:A.value},"card-style":{backgroundColor:B.value},onRequest:u},{top:l(a=>[o(Z,{flat:""},{default:l(()=>[_(o(p,{label:i(t)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=f=>u())},{default:l(()=>[o(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(c(i(t)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),[[h,i(d).userPermissionGet("Get User List")]]),_(o(p,{label:i(t)("new"),icon:"add",onClick:e[1]||(e[1]=f=>D())},{default:l(()=>[o(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(c(i(t)("newUser")),1)]),_:1})]),_:1},8,["label"]),[[h,i(d).userPermissionGet("Create One User")]])]),_:1}),o(ee),o(E,{dense:"",debounce:"300",color:"primary",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=f=>b.value=f),onInput:e[3]||(e[3]=f=>u()),onKeyup:e[4]||(e[4]=J(f=>u(),["enter"]))},{append:l(()=>[o(K,{name:"search"})]),_:1},8,["modelValue"]),o(p,{flat:"",round:"",dense:"",icon:a.inFullscreen?"fullscreen_exit":"fullscreen",onClick:a.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":l(a=>[o(te,{props:a},{default:l(()=>[a.col.name==="action"?(x(),G("div",de,[_(o(p,{round:"",flat:"",icon:"published_with_changes",onClick:f=>O(a.rowIndex)},{default:l(()=>[o(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(c(i(t)("changepassword")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(d).userPermissionGet("Change Password")]]),_(o(p,{round:"",flat:"",icon:"admin_panel_settings",onClick:f=>j(a.rowIndex)},{default:l(()=>[o(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(c(i(t)("permission")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(d).userPermissionGet("Set Permission For User")]]),_(o(p,{round:"",flat:"",icon:"lock_person",onClick:f=>I(a.rowIndex)},{default:l(()=>[o(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(c(i(t)("isnotactive")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,!a.row.is_active&&i(d).userPermissionGet("Lock & Unlock User")]]),_(o(p,{round:"",flat:"",icon:"lock_open",onClick:f=>I(a.rowIndex)},{default:l(()=>[o(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(c(i(t)("isactive")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,a.row.is_active&&i(d).userPermissionGet("Lock & Unlock User")]]),_(o(p,{round:"",flat:"",icon:"delete_sweep",onClick:f=>N(a.rowIndex)},{default:l(()=>[o(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(c(i(t)("deleteuser")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(d).userPermissionGet("Delete One User")]])])):(x(),G("div",ue,c(a.value),1))]),_:2},1032,["props"])]),pagination:l(()=>[v(c(i(t)("total"))+c(V.value)+" "+c(i(t)("page"))+" ",1),o(ae,{modelValue:g.value.page,"onUpdate:modelValue":[e[5]||(e[5]=a=>g.value.page=a),e[6]||(e[6]=a=>u())],max:V.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},be={__name:"TableReader",setup(T){const t=z(),n=r(!1),d=r(""),P=r(""),C=r("");return R(()=>({title:d.value,meta:{description:{name:"description",content:P.value},keywords:{name:"keywords",content:C.value}}})),L(()=>{}),X(()=>{}),S(()=>t.dark.isActive,y=>{n.value=y}),(y,m)=>(x(),Y(M,{class:"flex flex-top"},{default:l(()=>[o(ce)]),_:1}))}};export{be as default};
