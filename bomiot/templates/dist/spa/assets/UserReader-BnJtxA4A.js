import{Q as W}from"./QPage-DbGNdCeL.js";import{u as E}from"./use-meta-BqERCyEc.js";import{u as D}from"./use-quasar-Bk_OAqbA.js";import{u as K,Q as v}from"./QItemLabel-BtUMSWKk.js";import{a as Q,r,o as B,w as I,a5 as x,a6 as G,a9 as s,aa as l,J as k,ac as g,a8 as i,ab as p,ag as u,a7 as _,ay as H,aL as J,ak as X,at as Y,e as Z,ae as ee}from"./index-DbVLJLI3.js";import{a as te,b as ae}from"./rtl-kD0YC2jg.js";import{Q as ne,a as oe,b as se}from"./QTable-CRk74jX3.js";import{e as ie,g as le,p as h}from"./axios-zoEVadDN.js";import{u as re}from"./language-C_wcYhO5.js";import{u as de}from"./vue-i18n.runtime-DG0tbeBL.js";const ce={class:"q-pa-md"},ue={key:0},me={key:1},fe={__name:"UserList",setup(T){const{t:a}=de(),n=D(),d=K(),C=re(),U=Q(()=>[{name:"username",required:!0,label:a("username"),align:"left",field:"username"},{name:"date_joined",label:a("date_joined"),field:"date_joined"},{name:"last_login",label:a("last_login"),field:"last_login"},{name:"updated_time",label:a("updated_time"),field:"updated_time"},{name:"action",label:a("action"),align:"right"}]),w=Q(()=>d.token),m=r([]),P=r([]),L=r([]),b=r(""),$=r(0),y=r({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),S=Q(()=>w.value!==""?Math.ceil($.value/y.value.rowsPerPage):0),q=r(`${n.screen.height*.73}px`),A=r(`${n.screen.width*.825}px`),V=r(n.dark.isActive?"#121212":"#ffffff");function c(o){let e={};o?e=o:e.pagination=y.value,d.userPermissionGet("Get User List")&&(le({url:"core/user/",params:{search:b.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(t=>{m.value=t.results,$.value=t.count,P.value=t.team,L.value=t.department}).catch(t=>{n.notify({type:"error",message:t}),n.loading.hide()}),y.value=e.pagination)}function O(){n.dialog({dark:n.dark.isActive,title:a("newUser"),message:a("createuser"),prompt:{model:"",isValid:o=>o.length>2,type:"text"},cancel:!0}).onOk(o=>{h("core/user/create/",{username:o}).then(()=>{c()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})})}function F(o){n.dialog({dark:n.dark.isActive,title:a("changepassword"),message:a("changePWD"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(e=>{h("core/user/changepwd/",{id:m.value[o].id,pwd:e}).then(()=>{}).catch(t=>{n.notify({type:"error",message:t}),n.loading.hide()})})}function N(o){n.dialog({title:a("setteam"),message:a("chooseteam"),options:{type:"radio",model:m.value[o].team,items:P.value},cancel:!0}).onOk(e=>{h("core/user/team/",{id:m.value[o].id,team_id:e}).then(()=>{c()}).catch(t=>{n.notify({type:"error",message:t}),n.loading.hide()})})}function j(o){n.dialog({title:a("setdepartment"),message:a("choosedepartment"),options:{type:"radio",model:m.value[o].department,items:L.value},cancel:!0}).onOk(e=>{h("core/user/department/",{id:m.value[o].id,department_id:e}).then(()=>{c()}).catch(t=>{n.notify({type:"error",message:t}),n.loading.hide()})})}function z(o){h("core/user/lock/",{id:m.value[o].id}).then(()=>{c()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})}function M(o){n.dialog({dark:n.dark.isActive,title:a("deleteuser"),message:a("confirmnotice"),cancel:!0}).onOk(()=>{h("core/user/delete/",{id:m.value[o].id}).then(()=>{c()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})})}B(()=>{R(),c()}),I(()=>n.dark.isActive,o=>{V.value=o?"#121212":"#ffffff"});function R(){ie.on("needLogin",o=>{o&&(m.value=[],P.value=[],b.value="",$.value=0)})}return I(()=>C.langData,o=>{o&&c()}),(o,e)=>(x(),G("div",ce,[s(se,{class:Y(i(n).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:m.value,columns:U.value,"row-key":"index",pagination:y.value,"onUpdate:pagination":e[7]||(e[7]=t=>y.value=t),separator:"cell","no-data-label":i(a)("nodata"),"rows-per-page-label":i(a)("per_page"),"rows-per-page-options":[30,50,200,1e3],"table-style":{height:q.value,width:A.value},"card-style":{backgroundColor:V.value},onRequest:c},{top:l(t=>[s(te,{flat:""},{default:l(()=>[k(s(g,{label:i(a)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=f=>c())},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),[[_,i(d).userPermissionGet("Get User List")]]),k(s(g,{label:i(a)("new"),icon:"add",onClick:e[1]||(e[1]=f=>O())},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("newUser")),1)]),_:1})]),_:1},8,["label"]),[[_,i(d).userPermissionGet("Create One User")]])]),_:1}),s(ae),s(H,{dense:"",debounce:"300",color:"primary",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=f=>b.value=f),onInput:e[3]||(e[3]=f=>c()),onKeyup:e[4]||(e[4]=J(f=>c(),["enter"]))},{append:l(()=>[s(X,{name:"search"})]),_:1},8,["modelValue"]),s(g,{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen",onClick:t.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":l(t=>[s(ne,{props:t},{default:l(()=>[t.col.name==="action"?(x(),G("div",ue,[k(s(g,{round:"",flat:"",icon:"published_with_changes",onClick:f=>F(t.rowIndex)},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("changepassword")),1)]),_:1})]),_:2},1032,["onClick"]),[[_,i(d).userPermissionGet("Change Password")]]),k(s(g,{round:"",flat:"",icon:"diversity_3",onClick:f=>N(t.rowIndex)},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("setteam")),1)]),_:1})]),_:2},1032,["onClick"]),[[_,i(d).userPermissionGet("Set Team For User")]]),k(s(g,{round:"",flat:"",icon:"diversity_2",onClick:f=>j(t.rowIndex)},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("setdepartment")),1)]),_:1})]),_:2},1032,["onClick"]),[[_,i(d).userPermissionGet("Set Department For User")]]),k(s(g,{round:"",flat:"",icon:"lock_person",onClick:f=>z(t.rowIndex)},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("isnotactive")),1)]),_:1})]),_:2},1032,["onClick"]),[[_,!t.row.is_active&&i(d).userPermissionGet("Lock & Unlock User")]]),k(s(g,{round:"",flat:"",icon:"lock_open",onClick:f=>z(t.rowIndex)},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("isactive")),1)]),_:1})]),_:2},1032,["onClick"]),[[_,t.row.is_active&&i(d).userPermissionGet("Lock & Unlock User")]]),k(s(g,{round:"",flat:"",icon:"delete_sweep",onClick:f=>M(t.rowIndex)},{default:l(()=>[s(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[p(u(i(a)("deleteuser")),1)]),_:1})]),_:2},1032,["onClick"]),[[_,i(d).userPermissionGet("Delete One User")]])])):(x(),G("div",me,u(t.value),1))]),_:2},1032,["props"])]),pagination:l(()=>[p(u(i(a)("total"))+u(S.value)+" "+u(i(a)("page"))+" ",1),s(oe,{modelValue:y.value.page,"onUpdate:modelValue":[e[5]||(e[5]=t=>y.value.page=t),e[6]||(e[6]=t=>c())],max:S.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},Ce={__name:"UserReader",setup(T){const a=D(),n=r(!1),d=r(""),C=r(""),U=r("");return E(()=>({title:d.value,meta:{description:{name:"description",content:C.value},keywords:{name:"keywords",content:U.value}}})),B(()=>{}),Z(()=>{}),I(()=>a.dark.isActive,w=>{n.value=w}),(w,m)=>(x(),ee(W,{class:"flex flex-top"},{default:l(()=>[s(fe)]),_:1}))}};export{Ce as default};
