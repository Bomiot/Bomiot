import{Q as U}from"./QPage-ltF7SocP.js";import{u as O}from"./use-meta-CzUauSHJ.js";import{u as P}from"./use-quasar-3xwWZP-X.js";import{u as R,Q as y}from"./QItemLabel-DS2al5LE.js";import{d as Q,r,o as q,w as V,a4 as C,a5 as w,a8 as l,a9 as s,aa as f,af as c,a7 as i,ab as g,ax as E,aM as F,ai as K,as as j,j as G,ad as H}from"./index-C_Y_PPsx.js";import{b as W,a as J}from"./rtl-CKniQFeG.js";import{Q as X,a as Y,b as Z}from"./QTable-CXbehKl6.js";import{e as ee,g as te,p as $}from"./axios-CfM96r7k.js";import{u as ae}from"./language-B_adsXDX.js";import{u as ne}from"./vue-i18n.runtime-BehzTcvC.js";const oe={class:"q-pa-md"},le={key:0},se={key:1},re={__name:"DepartmentList",setup(A){const{t}=ne(),a=P(),b=R(),h=ae(),_=Q(()=>[{name:"name",required:!0,label:t("department.name"),align:"left",field:"name"},{name:"created_time",label:t("created_time"),field:"created_time"},{name:"updated_time",label:t("updated_time"),field:"updated_time"},{name:"action",label:t("action"),align:"right"}]),v=Q(()=>b.token),p=r([]),S=r([]),k=r(""),x=r(0),u=r({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),B=Q(()=>v.value!==""?Math.ceil(x.value/u.value.rowsPerPage):0),I=r(`${a.screen.height*.73}px`),T=r(`${a.screen.width*.825}px`),D=r(a.dark.isActive?"#121212":"#ffffff");function d(o){let e={};o?e=o:e.pagination=u.value,te({url:"core/department/",params:{search:k.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(n=>{p.value=n.results,x.value=n.count}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()}),u.value=e.pagination}function z(){a.dialog({dark:a.dark.isActive,title:t("department.new"),message:t("department.create"),prompt:{model:"",isValid:o=>o.length>2,type:"text"},cancel:!0}).onOk(async o=>{await $("core/department/create/",{name:o}).then(()=>{d()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}function L(o){a.dialog({dark:a.dark.isActive,title:t("department.change"),message:t("department.confirmchange"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(async e=>{await $("core/department/change/",{id:p.value[o].id,name:e}).then(()=>{d()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function M(o){a.dialog({dark:a.dark.isActive,title:t("department.delete"),message:t("confirmnotice"),cancel:!0}).onOk(async()=>{await $("core/department/delete/",{id:p.value[o].id}).then(()=>{d()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}q(()=>{N(),d()}),V(()=>a.dark.isActive,o=>{D.value=o?"#121212":"#ffffff"});function N(){ee.on("needLogin",o=>{o&&(p.value=[],S.value=[],k.value="",x.value=0)})}return V(()=>h.langData,o=>{o&&d()}),(o,e)=>(w(),C("div",oe,[l(Z,{class:j(i(a).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:p.value,columns:_.value,"row-key":"index",pagination:u.value,"onUpdate:pagination":e[7]||(e[7]=n=>u.value=n),separator:"cell","no-data-label":i(t)("nodata"),"rows-per-page-label":i(t)("per_page"),"rows-per-page-options":[1,30,50,200,1e3],"table-style":{height:I.value,width:T.value},"card-style":{backgroundColor:D.value},onRequest:d},{top:s(n=>[l(W,{flat:""},{default:s(()=>[l(g,{label:i(t)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=m=>d())},{default:s(()=>[l(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:s(()=>[f(c(i(t)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),l(g,{label:i(t)("new"),icon:"add",onClick:e[1]||(e[1]=m=>z())},{default:s(()=>[l(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:s(()=>[f(c(i(t)("department.new")),1)]),_:1})]),_:1},8,["label"])]),_:1}),l(J),l(E,{dense:"",debounce:"300",color:"primary",modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=m=>k.value=m),onInput:e[3]||(e[3]=m=>d()),onKeyup:e[4]||(e[4]=F(m=>d(),["enter"]))},{append:s(()=>[l(K,{name:"search"})]),_:1},8,["modelValue"]),l(g,{flat:"",round:"",dense:"",icon:n.inFullscreen?"fullscreen_exit":"fullscreen",onClick:n.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":s(n=>[l(Y,{props:n},{default:s(()=>[n.col.name==="action"?(w(),C("div",le,[l(g,{round:"",flat:"",icon:"edit",onClick:m=>L(n.rowIndex)},{default:s(()=>[l(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:s(()=>[f(c(i(t)("department.change")),1)]),_:1})]),_:2},1032,["onClick"]),l(g,{round:"",flat:"",icon:"delete_sweep",onClick:m=>M(n.rowIndex)},{default:s(()=>[l(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:s(()=>[f(c(i(t)("department.delete")),1)]),_:1})]),_:2},1032,["onClick"])])):(w(),C("div",se,c(n.value),1))]),_:2},1032,["props"])]),pagination:s(()=>[f(c(i(t)("total"))+c(B.value)+" "+c(i(t)("page"))+" ",1),l(X,{modelValue:u.value.page,"onUpdate:modelValue":[e[5]||(e[5]=n=>u.value.page=n),e[6]||(e[6]=n=>d())],max:B.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},ye={__name:"DepartmentReader",setup(A){const t=P(),a=r(!1),b=r(""),h=r(""),_=r("");return O(()=>({title:b.value,meta:{description:{name:"description",content:h.value},keywords:{name:"keywords",content:_.value}}})),q(()=>{}),G(()=>{}),V(()=>t.dark.isActive,v=>{a.value=v}),(v,p)=>(w(),H(U,{class:"flex flex-top"},{default:s(()=>[l(re)]),_:1}))}};export{ye as default};
