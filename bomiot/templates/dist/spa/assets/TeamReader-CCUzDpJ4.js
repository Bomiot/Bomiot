import{Q as D}from"./QPage-DyJhgu9-.js";import{u as G}from"./use-meta-DEGQOJxX.js";import{u as q}from"./use-quasar-i7f_Ax9y.js";import{u as R,Q as k}from"./QItemLabel-C1tGkUkV.js";import{$ as j,d as $,r as d,o as A,w as P,a4 as T,a5 as w,a8 as s,a9 as i,aa as f,af as c,a7 as l,ab as g,ax as E,aM as F,ai as K,as as H,j as W,ad as J}from"./index-BDb9PYS4.js";import{b as X,a as Y}from"./rtl-B5muQS70.js";import{Q as Z,a as ee,b as te}from"./QTable-BxEVrSv4.js";import{e as ae,g as ne,p as b}from"./axios-C8ARmMRm.js";import{u as oe}from"./language-Czmvhs3w.js";import{u as se}from"./vue-i18n.runtime-5NFOasNc.js";const ie=j("permission",{state:()=>({permission:[]}),getters:{permissionGet(v){return v.permission}},actions:{permissionChange(v){this.permission=v}},persist:{enable:!0}}),le={class:"q-pa-md"},re={key:0},de={key:1},ce={__name:"TeamList",setup(v){const{t}=se(),a=q(),x=R(),C=oe(),y=ie(),h=$(()=>[{name:"name",required:!0,label:t("team.name"),align:"left",field:"name"},{name:"created_time",label:t("created_time"),field:"created_time"},{name:"updated_time",label:t("updated_time"),field:"updated_time"},{name:"action",label:t("action"),align:"right"}]),V=$(()=>x.token),m=d([]),_=d(""),Q=d(0),p=d({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),S=$(()=>V.value!==""?Math.ceil(Q.value/p.value.rowsPerPage):0),I=d(`${a.screen.height*.73}px`),z=d(`${a.screen.width*.825}px`),B=d(a.dark.isActive?"#121212":"#ffffff");function r(o){let e={};o?e=o:e.pagination=p.value,ne({url:"core/team/",params:{search:_.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(n=>{m.value=n.results,Q.value=n.count,y.permissionChange(n.permission_list)}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()}),p.value=e.pagination}function O(){a.dialog({dark:a.dark.isActive,title:t("team.new"),message:t("team.create"),prompt:{model:"",isValid:o=>o.length>2,type:"text"},cancel:!0}).onOk(async o=>{await b("core/team/create/",{name:o}).then(()=>{r()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}function L(o){a.dialog({dark:a.dark.isActive,title:t("team.change"),message:t("team.changeteam"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(async e=>{await b("core/team/change/",{id:m.value[o].id,name:e}).then(()=>{r()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function M(o){a.dialog({title:t("team.permission"),message:t("team.choosepermission"),options:{type:"checkbox",model:Object.keys(m.value[o].permission),inline:!0,items:y.permissionGet},cancel:!0}).onOk(async e=>{await b("core/team/setpermission/",{id:m.value[o].id,permission:e}).then(()=>{r()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function N(o){a.dialog({dark:a.dark.isActive,title:t("team.delete"),message:t("confirmnotice"),cancel:!0}).onOk(async()=>{await b("core/team/delete/",{id:m.value[o].id}).then(()=>{r()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}A(()=>{U(),r()}),P(()=>a.dark.isActive,o=>{B.value=o?"#121212":"#ffffff"});function U(){ae.on("needLogin",o=>{o&&(m.value=[],_.value="",Q.value=0)})}return P(()=>C.langData,o=>{o&&r()}),(o,e)=>(w(),T("div",le,[s(te,{class:H(l(a).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:m.value,columns:h.value,"row-key":"index",pagination:p.value,"onUpdate:pagination":e[7]||(e[7]=n=>p.value=n),separator:"cell","no-data-label":l(t)("nodata"),"rows-per-page-label":l(t)("per_page"),"rows-per-page-options":[1,30,50,200,1e3],"table-style":{height:I.value,width:z.value},"card-style":{backgroundColor:B.value},onRequest:r},{top:i(n=>[s(X,{flat:""},{default:i(()=>[s(g,{label:l(t)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=u=>r())},{default:i(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[f(c(l(t)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),s(g,{label:l(t)("new"),icon:"add",onClick:e[1]||(e[1]=u=>O())},{default:i(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[f(c(l(t)("team.new")),1)]),_:1})]),_:1},8,["label"])]),_:1}),s(Y),s(E,{dense:"",debounce:"300",color:"primary",modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=u=>_.value=u),onInput:e[3]||(e[3]=u=>r()),onKeyup:e[4]||(e[4]=F(u=>r(),["enter"]))},{append:i(()=>[s(K,{name:"search"})]),_:1},8,["modelValue"]),s(g,{flat:"",round:"",dense:"",icon:n.inFullscreen?"fullscreen_exit":"fullscreen",onClick:n.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":i(n=>[s(ee,{props:n},{default:i(()=>[n.col.name==="action"?(w(),T("div",re,[s(g,{round:"",flat:"",icon:"edit",onClick:u=>L(n.rowIndex)},{default:i(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[f(c(l(t)("team.change")),1)]),_:1})]),_:2},1032,["onClick"]),s(g,{round:"",flat:"",icon:"admin_panel_settings",onClick:u=>M(n.rowIndex)},{default:i(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[f(c(l(t)("team.permission")),1)]),_:1})]),_:2},1032,["onClick"]),s(g,{round:"",flat:"",icon:"delete_sweep",onClick:u=>N(n.rowIndex)},{default:i(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[f(c(l(t)("team.delete")),1)]),_:1})]),_:2},1032,["onClick"])])):(w(),T("div",de,c(n.value),1))]),_:2},1032,["props"])]),pagination:i(()=>[f(c(l(t)("total"))+c(S.value)+" "+c(l(t)("page"))+" ",1),s(Z,{modelValue:p.value.page,"onUpdate:modelValue":[e[5]||(e[5]=n=>p.value.page=n),e[6]||(e[6]=n=>r())],max:S.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},be={__name:"TeamReader",setup(v){const t=q(),a=d(!1),x=d(""),C=d(""),y=d("");return G(()=>({title:x.value,meta:{description:{name:"description",content:C.value},keywords:{name:"keywords",content:y.value}}})),A(()=>{}),W(()=>{}),P(()=>t.dark.isActive,h=>{a.value=h}),(h,V)=>(w(),J(D,{class:"flex flex-top"},{default:i(()=>[s(ce)]),_:1}))}};export{be as default};
