import{Q as W}from"./QPage-DyJhgu9-.js";import{u as E}from"./use-meta-DEGQOJxX.js";import{u as T}from"./use-quasar-i7f_Ax9y.js";import{u as F,Q as v}from"./QItemLabel-C1tGkUkV.js";import{d as $,r,o as q,w as S,a4 as P,a5 as y,a8 as o,a9 as l,aa as g,af as c,a7 as i,M as U,ab as p,a6 as z,ax as K,aM as G,ai as H,as as J,j as X,ad as Y}from"./index-BDb9PYS4.js";import{b as Z,a as ee}from"./rtl-B5muQS70.js";import{Q as ae,a as te,b as ne}from"./QTable-BxEVrSv4.js";import{e as oe,g as se,p as k}from"./axios-C8ARmMRm.js";import{u as le}from"./language-Czmvhs3w.js";import{u as ie}from"./vue-i18n.runtime-5NFOasNc.js";const re={class:"q-pa-md"},de={key:0},ce={key:1},ue={__name:"TableList",setup(A){const{t:a}=ie(),n=T(),b=F(),w=le(),x=$(()=>[{name:"username",required:!0,label:a("username"),align:"left",field:"username"},{name:"email",align:"center",label:a("email"),field:"email"},{name:"date_joined",label:a("date_joined"),field:"date_joined"},{name:"last_login",label:a("last_login"),field:"last_login"},{name:"updated_time",label:a("updated_time"),field:"updated_time",sortable:!0},{name:"action",label:a("action"),align:"right"}]),_=$(()=>b.token),f=r([]),C=r([]),h=r(""),Q=r(0),m=r({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),V=$(()=>_.value!==""?Math.ceil(Q.value/m.value.rowsPerPage):0),j=r(n.screen.height*.73+"px"),D=r(n.screen.width*.825+"px"),B=r(n.dark.isActive?"#121212":"#ffffff");function d(s){let e={};s?e=s:e.pagination=m.value,se({url:"core/user/",params:{search:h.value,ordering:(m.value.descending?"-":"")+m.value.sortBy,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(t=>{t.login||(f.value=t.results,Q.value=t.count,C.value=t.permission)}).catch(t=>(n.loading.hide(),Promise.reject(t))),m.value=e.pagination}function M(){n.dialog({dark:n.dark.isActive,title:a("newUser"),message:a("createuser"),prompt:{model:"",isValid:s=>s.length>2,type:"text"},cancel:!0}).onOk(s=>{k("core/user/create/",{username:s}).then(()=>{d()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})})}function O(s){n.dialog({dark:n.dark.isActive,title:a("changepassword"),message:a("changePWD"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(e=>{k("core/user/changepwd/",{id:f.value[s].id,pwd:e}).then(()=>{}).catch(t=>{n.notify({type:"error",message:t}),n.loading.hide()})})}function L(s){n.dialog({title:a("permission"),message:a("choosepermission"),options:{type:"checkbox",model:Object.keys(f.value[s].permission),inline:!0,items:C.value},cancel:!0}).onOk(e=>{k("core/user/setpermission/",{id:f.value[s].id,permission:e}).then(()=>{d()}).catch(t=>{n.notify({type:"error",message:t}),n.loading.hide()})})}function I(s){k("core/user/lock/",{id:f.value[s].id}).then(()=>{d()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})}function N(s){n.dialog({dark:n.dark.isActive,title:a("deleteuser"),message:a("confirmnotice"),cancel:!0}).onOk(()=>{k("core/user/delete/",{id:f.value[s].id}).then(()=>{d()}).catch(e=>{n.notify({type:"error",message:e}),n.loading.hide()})})}q(()=>{R(),d()}),S(()=>n.dark.isActive,s=>{B.value=s?"#121212":"#ffffff"});function R(){oe.on("needLogin",s=>{s&&(f.value=[],C.value=[],h.value="",Q.value=0)})}return S(()=>w.langData,s=>{s&&d()}),(s,e)=>(y(),P("div",re,[o(ne,{class:J(i(n).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:f.value,columns:x.value,"row-key":"index",pagination:m.value,"onUpdate:pagination":e[7]||(e[7]=t=>m.value=t),separator:"cell","no-data-label":i(a)("nodata"),"rows-per-page-label":i(a)("per_page"),"rows-per-page-options":[10,30,50,200,1e3],"table-style":{height:j.value,width:D.value},"card-style":{backgroundColor:B.value},onRequest:d},{top:l(t=>[o(Z,{flat:""},{default:l(()=>[o(p,{label:i(a)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=u=>d())},{default:l(()=>[o(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(i(a)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),o(p,{label:i(a)("new"),icon:"add",onClick:e[1]||(e[1]=u=>M())},{default:l(()=>[o(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(i(a)("newUser")),1)]),_:1})]),_:1},8,["label"])]),_:1}),o(ee),o(K,{dense:"",debounce:"300",color:"primary",modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=u=>h.value=u),onInput:e[3]||(e[3]=u=>d()),onKeyup:e[4]||(e[4]=G(u=>d(),["enter"]))},{append:l(()=>[o(H,{name:"search"})]),_:1},8,["modelValue"]),o(p,{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen",onClick:t.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":l(t=>[o(te,{props:t},{default:l(()=>[t.col.name==="action"?(y(),P("div",de,[o(p,{round:"",flat:"",icon:"published_with_changes",onClick:u=>O(t.rowIndex)},{default:l(()=>[o(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(i(a)("changepassword")),1)]),_:1})]),_:2},1032,["onClick"]),o(p,{round:"",flat:"",icon:"admin_panel_settings",onClick:u=>L(t.rowIndex)},{default:l(()=>[o(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(i(a)("permission")),1)]),_:1})]),_:2},1032,["onClick"]),U(o(p,{round:"",flat:"",icon:"lock_person",onClick:u=>I(t.rowIndex)},{default:l(()=>[o(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(i(a)("isnotactive")),1)]),_:1})]),_:2},1032,["onClick"]),[[z,!t.row.is_active]]),U(o(p,{round:"",flat:"",icon:"lock_open",onClick:u=>I(t.rowIndex)},{default:l(()=>[o(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(i(a)("isactive")),1)]),_:1})]),_:2},1032,["onClick"]),[[z,t.row.is_active]]),o(p,{round:"",flat:"",icon:"delete_sweep",onClick:u=>N(t.rowIndex)},{default:l(()=>[o(v,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(i(a)("deleteuser")),1)]),_:1})]),_:2},1032,["onClick"])])):(y(),P("div",ce,c(t.value),1))]),_:2},1032,["props"])]),pagination:l(()=>[g(c(i(a)("total"))+c(V.value)+" "+c(i(a)("page"))+" ",1),o(ae,{modelValue:m.value.page,"onUpdate:modelValue":[e[5]||(e[5]=t=>m.value.page=t),e[6]||(e[6]=t=>d())],max:V.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},we={__name:"TableReader",setup(A){const a=T(),n=r(!1),b=r(""),w=r(""),x=r("");return E(()=>({title:b.value,meta:{description:{name:"description",content:w.value},keywords:{name:"keywords",content:x.value}}})),q(()=>{}),X(()=>{}),S(()=>a.dark.isActive,_=>{n.value=_}),(_,f)=>(y(),Y(W,{class:"flex flex-top"},{default:l(()=>[o(ue)]),_:1}))}};export{we as default};
