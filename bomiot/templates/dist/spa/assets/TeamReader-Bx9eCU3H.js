import{Q as D}from"./QPage-ltF7SocP.js";import{u as O}from"./use-meta-CzUauSHJ.js";import{u as q}from"./use-quasar-3xwWZP-X.js";import{u as R,Q as h}from"./QItemLabel-DS2al5LE.js";import{$ as E,d as Q,r,o as A,w as V,a4 as $,a5 as b,a8 as s,a9 as i,aa as g,af as c,a7 as l,ab as v,ax as F,aM as G,ai as K,as as j,j as H,ad as W}from"./index-C_Y_PPsx.js";import{b as J,a as X}from"./rtl-CKniQFeG.js";import{Q as Y,a as Z,b as ee}from"./QTable-CXbehKl6.js";import{e as ae,g as te,p as T}from"./axios-CfM96r7k.js";import{u as ne}from"./language-B_adsXDX.js";import{u as oe}from"./vue-i18n.runtime-BehzTcvC.js";const se=E("permission",{state:()=>({permission:[]}),getters:{permissionGet(p){return p.permission}},actions:{permissionChange(p){this.permission=p}},persist:{enable:!0}}),ie={class:"q-pa-md"},le={key:0},re={key:1},de={__name:"TeamList",setup(p){const{t:a}=oe(),t=q(),w=R(),_=ne(),x=se(),k=Q(()=>[{name:"name",required:!0,label:a("team.name"),align:"left",field:"name"},{name:"created_time",label:a("created_time"),field:"created_time"},{name:"updated_time",label:a("updated_time"),field:"updated_time"},{name:"action",label:a("action"),align:"right"}]),P=Q(()=>w.token),f=r([]),y=r(""),C=r(0),u=r({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),S=Q(()=>P.value!==""?Math.ceil(C.value/u.value.rowsPerPage):0),I=r(`${t.screen.height*.73}px`),z=r(`${t.screen.width*.825}px`),B=r(t.dark.isActive?"#121212":"#ffffff");function d(o){let e={};o?e=o:e.pagination=u.value,te({url:"core/team/",params:{search:y.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(n=>{f.value=n.results,C.value=n.count,x.permissionChange(n.permission_list)}).catch(n=>{t.notify({type:"error",message:n}),t.loading.hide()}),u.value=e.pagination}function L(){t.dialog({dark:t.dark.isActive,title:a("team.new"),message:a("team.create"),prompt:{model:"",isValid:o=>o.length>2,type:"text"},cancel:!0}).onOk(async o=>{await T("core/team/create/",{name:o}).then(()=>{d()}).catch(e=>{t.notify({type:"error",message:e}),t.loading.hide()})})}function M(o){t.dialog({dark:t.dark.isActive,title:a("team.change"),message:a("team.changeteam"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(async e=>{await T("core/team/change/",{id:f.value[o].id,name:e}).then(()=>{d()}).catch(n=>{t.notify({type:"error",message:n}),t.loading.hide()})})}function N(o){t.dialog({dark:t.dark.isActive,title:a("team.delete"),message:a("confirmnotice"),cancel:!0}).onOk(async()=>{await T("core/team/delete/",{id:f.value[o].id}).then(()=>{d()}).catch(e=>{t.notify({type:"error",message:e}),t.loading.hide()})})}A(()=>{U(),d()}),V(()=>t.dark.isActive,o=>{B.value=o?"#121212":"#ffffff"});function U(){ae.on("needLogin",o=>{o&&(f.value=[],y.value="",C.value=0)})}return V(()=>_.langData,o=>{o&&d()}),(o,e)=>(b(),$("div",ie,[s(ee,{class:j(l(t).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:f.value,columns:k.value,"row-key":"index",pagination:u.value,"onUpdate:pagination":e[7]||(e[7]=n=>u.value=n),separator:"cell","no-data-label":l(a)("nodata"),"rows-per-page-label":l(a)("per_page"),"rows-per-page-options":[1,30,50,200,1e3],"table-style":{height:I.value,width:z.value},"card-style":{backgroundColor:B.value},onRequest:d},{top:i(n=>[s(J,{flat:""},{default:i(()=>[s(v,{label:l(a)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=m=>d())},{default:i(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[g(c(l(a)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),s(v,{label:l(a)("new"),icon:"add",onClick:e[1]||(e[1]=m=>L())},{default:i(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[g(c(l(a)("team.new")),1)]),_:1})]),_:1},8,["label"])]),_:1}),s(X),s(F,{dense:"",debounce:"300",color:"primary",modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=m=>y.value=m),onInput:e[3]||(e[3]=m=>d()),onKeyup:e[4]||(e[4]=G(m=>d(),["enter"]))},{append:i(()=>[s(K,{name:"search"})]),_:1},8,["modelValue"]),s(v,{flat:"",round:"",dense:"",icon:n.inFullscreen?"fullscreen_exit":"fullscreen",onClick:n.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":i(n=>[s(Z,{props:n},{default:i(()=>[n.col.name==="action"?(b(),$("div",le,[s(v,{round:"",flat:"",icon:"edit",onClick:m=>M(n.rowIndex)},{default:i(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[g(c(l(a)("team.change")),1)]),_:1})]),_:2},1032,["onClick"]),s(v,{round:"",flat:"",icon:"delete_sweep",onClick:m=>N(n.rowIndex)},{default:i(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:i(()=>[g(c(l(a)("team.delete")),1)]),_:1})]),_:2},1032,["onClick"])])):(b(),$("div",re,c(n.value),1))]),_:2},1032,["props"])]),pagination:i(()=>[g(c(l(a)("total"))+c(S.value)+" "+c(l(a)("page"))+" ",1),s(Y,{modelValue:u.value.page,"onUpdate:modelValue":[e[5]||(e[5]=n=>u.value.page=n),e[6]||(e[6]=n=>d())],max:S.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},be={__name:"TeamReader",setup(p){const a=q(),t=r(!1),w=r(""),_=r(""),x=r("");return O(()=>({title:w.value,meta:{description:{name:"description",content:_.value},keywords:{name:"keywords",content:x.value}}})),A(()=>{}),H(()=>{}),V(()=>a.dark.isActive,k=>{t.value=k}),(k,P)=>(b(),W(D,{class:"flex flex-top"},{default:i(()=>[s(de)]),_:1}))}};export{be as default};
