import{Q as M}from"./QPage-yVQa7NMe.js";import{u as O}from"./use-meta-BCCGAtcF.js";import{u as B}from"./use-quasar-DMvh-O4G.js";import{u as R,Q as h}from"./QItemLabel-By-EDHpl.js";import{a as P,r as i,o as S,w as V,a2 as Q,a3 as _,a6 as s,a7 as l,a8 as g,ad as c,a5 as r,K as w,a9 as v,a4 as b,av as E,aJ as F,ag as H,aq as J,e as W,ab as j}from"./index-CW7bXRGx.js";import{a as X,b as Y}from"./rtl-C5W-Fgak.js";import{Q as Z,a as ee,b as te}from"./QTable-D5jfZGyI.js";import{e as ae,a as ne,t as $}from"./axios-8Qm6Y-QI.js";import{u as oe}from"./language-DL4TzfLp.js";import{u as se}from"./vue-i18n.runtime-LLxG5jvi.js";const re={class:"q-pa-md"},le={key:0},ie={key:1},de={__name:"DepartmentList",setup(A){const{t}=se(),a=B(),u=R(),x=oe(),D=P(()=>[{name:"name",required:!0,label:t("department.name"),align:"left",field:"name"},{name:"created_time",label:t("created_time"),field:"created_time"},{name:"updated_time",label:t("updated_time"),field:"updated_time"},{name:"action",label:t("action"),align:"right"}]),k=P(()=>u.token),f=i([]),I=i([]),y=i(""),C=i(0),m=i({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),G=P(()=>k.value!==""?Math.ceil(C.value/m.value.rowsPerPage):0),L=i(`${a.screen.height*.73}px`),T=i(`${a.screen.width*.825}px`),q=i(a.dark.isActive?"#121212":"#ffffff");function d(o){let e={};o?e=o:e.pagination=m.value,u.userPermissionGet("Get Department List")&&(ne({url:"core/department/",params:{search:y.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(n=>{f.value=n.results,C.value=n.count}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()}),m.value=e.pagination)}function z(){a.dialog({dark:a.dark.isActive,title:t("department.new"),message:t("department.create"),prompt:{model:"",isValid:o=>o.length>2,type:"text"},cancel:!0}).onOk(async o=>{await $("core/department/create/",{name:o}).then(()=>{d()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}function N(o){a.dialog({dark:a.dark.isActive,title:t("department.change"),message:t("department.confirmchange"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(async e=>{await $("core/department/change/",{id:f.value[o].id,name:e}).then(()=>{d()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function U(o){a.dialog({dark:a.dark.isActive,title:t("department.delete"),message:t("confirmnotice"),cancel:!0}).onOk(async()=>{await $("core/department/delete/",{id:f.value[o].id}).then(()=>{d()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}S(()=>{K(),d()}),V(()=>a.dark.isActive,o=>{q.value=o?"#121212":"#ffffff"});function K(){ae.on("needLogin",o=>{o&&(f.value=[],I.value=[],y.value="",C.value=0)})}return V(()=>x.langData,o=>{o&&d()}),(o,e)=>(_(),Q("div",re,[s(te,{class:J(r(a).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:f.value,columns:D.value,"row-key":"index",pagination:m.value,"onUpdate:pagination":e[7]||(e[7]=n=>m.value=n),separator:"cell","no-data-label":r(t)("nodata"),"rows-per-page-label":r(t)("per_page"),"rows-per-page-options":[1,30,50,200,1e3],"table-style":{height:L.value,width:T.value},"card-style":{backgroundColor:q.value},onRequest:d},{top:l(n=>[s(X,{flat:""},{default:l(()=>[w(s(v,{label:r(t)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=p=>d())},{default:l(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(r(t)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),[[b,r(u).userPermissionGet("Get Department List")]]),w(s(v,{label:r(t)("new"),icon:"add",onClick:e[1]||(e[1]=p=>z())},{default:l(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(r(t)("department.new")),1)]),_:1})]),_:1},8,["label"]),[[b,r(u).userPermissionGet("Create Department")]])]),_:1}),s(Y),s(E,{dense:"",debounce:"300",color:"primary",modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=p=>y.value=p),onInput:e[3]||(e[3]=p=>d()),onKeyup:e[4]||(e[4]=F(p=>d(),["enter"]))},{append:l(()=>[s(H,{name:"search"})]),_:1},8,["modelValue"]),s(v,{flat:"",round:"",dense:"",icon:n.inFullscreen?"fullscreen_exit":"fullscreen",onClick:n.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":l(n=>[s(ee,{props:n},{default:l(()=>[n.col.name==="action"?(_(),Q("div",le,[w(s(v,{round:"",flat:"",icon:"edit",onClick:p=>N(n.rowIndex)},{default:l(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(r(t)("department.change")),1)]),_:1})]),_:2},1032,["onClick"]),[[b,r(u).userPermissionGet("Change Department")]]),w(s(v,{round:"",flat:"",icon:"delete_sweep",onClick:p=>U(n.rowIndex)},{default:l(()=>[s(h,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(c(r(t)("department.delete")),1)]),_:1})]),_:2},1032,["onClick"]),[[b,r(u).userPermissionGet("Delete Department")]])])):(_(),Q("div",ie,c(n.value),1))]),_:2},1032,["props"])]),pagination:l(()=>[g(c(r(t)("total"))+c(G.value)+" "+c(r(t)("page"))+" ",1),s(Z,{modelValue:m.value.page,"onUpdate:modelValue":[e[5]||(e[5]=n=>m.value.page=n),e[6]||(e[6]=n=>d())],max:G.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},we={__name:"DepartmentReader",setup(A){const t=B(),a=i(!1),u=i(""),x=i(""),D=i("");return O(()=>({title:u.value,meta:{description:{name:"description",content:x.value},keywords:{name:"keywords",content:D.value}}})),S(()=>{}),W(()=>{}),V(()=>t.dark.isActive,k=>{a.value=k}),(k,f)=>(_(),j(M,{class:"flex flex-top"},{default:l(()=>[s(de)]),_:1}))}};export{we as default};
