import{Q as M}from"./QPage-DbGNdCeL.js";import{u as R}from"./use-meta-BqERCyEc.js";import{u as q}from"./use-quasar-Bk_OAqbA.js";import{u as E,Q as k}from"./QItemLabel-BtUMSWKk.js";import{a as $,r,o as A,w as G,a5 as x,a6 as V,a9 as s,aa as l,J as y,ac as g,a8 as i,ab as v,ag as u,a7 as h,ay as K,aL as j,ak as H,at as J,e as W,ae as X}from"./index-DbVLJLI3.js";import{a as Y,b as Z}from"./rtl-kD0YC2jg.js";import{Q as ee,a as te,b as ae}from"./QTable-CRk74jX3.js";import{e as ne,g as oe,p as w}from"./axios-zoEVadDN.js";import{u as se}from"./language-C_wcYhO5.js";import{u as ie}from"./vue-i18n.runtime-DG0tbeBL.js";const le={class:"q-pa-md"},re={key:0},de={key:1},ce={__name:"TeamList",setup(I){const{t}=ie(),a=q(),c=E(),C=se(),P=$(()=>[{name:"name",required:!0,label:t("team.name"),align:"left",field:"name"},{name:"created_time",label:t("created_time"),field:"created_time"},{name:"updated_time",label:t("updated_time"),field:"updated_time"},{name:"action",label:t("action"),align:"right"}]),_=$(()=>c.token),m=r([]),T=r([]),b=r(""),Q=r(0),f=r({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),S=$(()=>_.value!==""?Math.ceil(Q.value/f.value.rowsPerPage):0),L=r(`${a.screen.height*.73}px`),z=r(`${a.screen.width*.825}px`),B=r(a.dark.isActive?"#121212":"#ffffff");function d(o){let e={};o?e=o:e.pagination=f.value,c.userPermissionGet("Get Team List")&&(oe({url:"core/team/",params:{search:b.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(n=>{m.value=n.results,Q.value=n.count,T.value=n.permission}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()}),f.value=e.pagination)}function O(){a.dialog({dark:a.dark.isActive,title:t("team.new"),message:t("team.create"),prompt:{model:"",isValid:o=>o.length>2,type:"text"},cancel:!0}).onOk(o=>{w("core/team/create/",{name:o}).then(()=>{d()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}function D(o){a.dialog({dark:a.dark.isActive,title:t("team.change"),message:t("team.changeteam"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(e=>{w("core/team/change/",{id:m.value[o].id,name:e}).then(()=>{d()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function U(o){a.dialog({title:t("team.permission"),message:t("team.choosepermission"),options:{type:"checkbox",model:Object.keys(m.value[o].permission),inline:!0,items:T.value},cancel:!0}).onOk(e=>{w("core/team/setpermission/",{id:m.value[o].id,permission:e}).then(()=>{d()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function N(o){a.dialog({dark:a.dark.isActive,title:t("team.delete"),message:t("confirmnotice"),cancel:!0}).onOk(()=>{w("core/team/delete/",{id:m.value[o].id}).then(()=>{d()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}A(()=>{F(),d()}),G(()=>a.dark.isActive,o=>{B.value=o?"#121212":"#ffffff"});function F(){ne.on("needLogin",o=>{o&&(m.value=[],T.value=[],b.value="",Q.value=0)})}return G(()=>C.langData,o=>{o&&d()}),(o,e)=>(x(),V("div",le,[s(ae,{class:J(i(a).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:m.value,columns:P.value,"row-key":"index",pagination:f.value,"onUpdate:pagination":e[7]||(e[7]=n=>f.value=n),separator:"cell","no-data-label":i(t)("nodata"),"rows-per-page-label":i(t)("per_page"),"rows-per-page-options":[1,30,50,200,1e3],"table-style":{height:L.value,width:z.value},"card-style":{backgroundColor:B.value},onRequest:d},{top:l(n=>[s(Y,{flat:""},{default:l(()=>[y(s(g,{label:i(t)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=p=>d())},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),[[h,i(c).userPermissionGet("Get User List")]]),y(s(g,{label:i(t)("new"),icon:"add",onClick:e[1]||(e[1]=p=>O())},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.new")),1)]),_:1})]),_:1},8,["label"]),[[h,i(c).userPermissionGet("Create One Team")]])]),_:1}),s(Z),s(K,{dense:"",debounce:"300",color:"primary",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=p=>b.value=p),onInput:e[3]||(e[3]=p=>d()),onKeyup:e[4]||(e[4]=j(p=>d(),["enter"]))},{append:l(()=>[s(H,{name:"search"})]),_:1},8,["modelValue"]),s(g,{flat:"",round:"",dense:"",icon:n.inFullscreen?"fullscreen_exit":"fullscreen",onClick:n.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":l(n=>[s(ee,{props:n},{default:l(()=>[n.col.name==="action"?(x(),V("div",re,[y(s(g,{round:"",flat:"",icon:"edit",onClick:p=>D(n.rowIndex)},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.change")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(c).userPermissionGet("Change Team")]]),y(s(g,{round:"",flat:"",icon:"admin_panel_settings",onClick:p=>U(n.rowIndex)},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.permission")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(c).userPermissionGet("Set Permission For Team")]]),y(s(g,{round:"",flat:"",icon:"delete_sweep",onClick:p=>N(n.rowIndex)},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.delete")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(c).userPermissionGet("Delete Team")]])])):(x(),V("div",de,u(n.value),1))]),_:2},1032,["props"])]),pagination:l(()=>[v(u(i(t)("total"))+u(S.value)+" "+u(i(t)("page"))+" ",1),s(te,{modelValue:f.value.page,"onUpdate:modelValue":[e[5]||(e[5]=n=>f.value.page=n),e[6]||(e[6]=n=>d())],max:S.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},be={__name:"TeamReader",setup(I){const t=q(),a=r(!1),c=r(""),C=r(""),P=r("");return R(()=>({title:c.value,meta:{description:{name:"description",content:C.value},keywords:{name:"keywords",content:P.value}}})),A(()=>{}),W(()=>{}),G(()=>t.dark.isActive,_=>{a.value=_}),(_,m)=>(x(),X(M,{class:"flex flex-top"},{default:l(()=>[s(ce)]),_:1}))}};export{be as default};
