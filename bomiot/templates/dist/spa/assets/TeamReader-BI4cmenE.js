import{Q as M}from"./QPage-Cbwj6EO4.js";import{u as R}from"./use-meta-T7rPjses.js";import{u as q}from"./use-quasar-f8m-PZpx.js";import{u as E,Q as k}from"./QItemLabel-DDMdkE6q.js";import{a as Q,r as d,o as A,w as G,a2 as x,a3 as $,a6 as s,a7 as l,J as y,a9 as g,a5 as i,a8 as v,ad as u,a4 as h,aw as J,aJ as K,ai as j,ar as H,e as W,ab as X}from"./index-DC_W_xoa.js";import{a as Y,b as Z}from"./rtl-BeMP6JtA.js";import{Q as ee,a as te,b as ae}from"./QTable-DCz45Q1T.js";import{e as ne,g as oe,p as w}from"./axios-2C-KJX3t.js";import{u as se}from"./language-h3alFOcN.js";import{u as ie}from"./permission-Nl867fJd.js";import{u as le}from"./vue-i18n.runtime-CWmhyg6E.js";const re={class:"q-pa-md"},de={key:0},ce={key:1},ue={__name:"TeamList",setup(I){const{t}=le(),a=q(),c=E(),P=se(),C=ie(),_=Q(()=>[{name:"name",required:!0,label:t("team.name"),align:"left",field:"name"},{name:"created_time",label:t("created_time"),field:"created_time"},{name:"updated_time",label:t("updated_time"),field:"updated_time"},{name:"action",label:t("action"),align:"right"}]),S=Q(()=>c.token),p=d([]),b=d(""),T=d(0),f=d({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),V=Q(()=>S.value!==""?Math.ceil(T.value/f.value.rowsPerPage):0),z=d(`${a.screen.height*.73}px`),L=d(`${a.screen.width*.825}px`),B=d(a.dark.isActive?"#121212":"#ffffff");function r(o){let e={};o?e=o:e.pagination=f.value,c.userPermissionGet("Get Team List")&&(oe({url:"core/team/",params:{search:b.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(n=>{p.value=n.results,T.value=n.count}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()}),f.value=e.pagination)}function O(){a.dialog({dark:a.dark.isActive,title:t("team.new"),message:t("team.create"),prompt:{model:"",isValid:o=>o.length>2,type:"text"},cancel:!0}).onOk(o=>{w("core/team/create/",{name:o}).then(()=>{r()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}function D(o){a.dialog({dark:a.dark.isActive,title:t("team.change"),message:t("team.changeteam"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(e=>{w("core/team/change/",{id:p.value[o].id,name:e}).then(()=>{r()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function U(o){a.dialog({title:t("team.permission"),message:t("team.choosepermission"),options:{type:"checkbox",model:Object.keys(p.value[o].permission),inline:!0,items:C.permissionGet},cancel:!0}).onOk(e=>{w("core/team/setpermission/",{id:p.value[o].id,permission:e}).then(()=>{r()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function N(o){a.dialog({dark:a.dark.isActive,title:t("team.delete"),message:t("confirmnotice"),cancel:!0}).onOk(()=>{w("core/team/delete/",{id:p.value[o].id}).then(()=>{r()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}A(()=>{F(),r()}),G(()=>a.dark.isActive,o=>{B.value=o?"#121212":"#ffffff"});function F(){ne.on("needLogin",o=>{o&&(p.value=[],b.value="",T.value=0)})}return G(()=>P.langData,o=>{o&&r()}),(o,e)=>(x(),$("div",re,[s(ae,{class:H(i(a).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:p.value,columns:_.value,"row-key":"index",pagination:f.value,"onUpdate:pagination":e[7]||(e[7]=n=>f.value=n),separator:"cell","no-data-label":i(t)("nodata"),"rows-per-page-label":i(t)("per_page"),"rows-per-page-options":[1,30,50,200,1e3],"table-style":{height:z.value,width:L.value},"card-style":{backgroundColor:B.value},onRequest:r},{top:l(n=>[s(Y,{flat:""},{default:l(()=>[y(s(g,{label:i(t)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=m=>r())},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),[[h,i(c).userPermissionGet("Get User List")]]),y(s(g,{label:i(t)("new"),icon:"add",onClick:e[1]||(e[1]=m=>O())},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.new")),1)]),_:1})]),_:1},8,["label"]),[[h,i(c).userPermissionGet("Create One Team")]])]),_:1}),s(Z),s(J,{dense:"",debounce:"300",color:"primary",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=m=>b.value=m),onInput:e[3]||(e[3]=m=>r()),onKeyup:e[4]||(e[4]=K(m=>r(),["enter"]))},{append:l(()=>[s(j,{name:"search"})]),_:1},8,["modelValue"]),s(g,{flat:"",round:"",dense:"",icon:n.inFullscreen?"fullscreen_exit":"fullscreen",onClick:n.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":l(n=>[s(ee,{props:n},{default:l(()=>[n.col.name==="action"?(x(),$("div",de,[y(s(g,{round:"",flat:"",icon:"edit",onClick:m=>D(n.rowIndex)},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.change")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(c).userPermissionGet("Change Team")]]),y(s(g,{round:"",flat:"",icon:"admin_panel_settings",onClick:m=>U(n.rowIndex)},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.permission")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(c).userPermissionGet("Set Permission For Team")]]),y(s(g,{round:"",flat:"",icon:"delete_sweep",onClick:m=>N(n.rowIndex)},{default:l(()=>[s(k,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[v(u(i(t)("team.delete")),1)]),_:1})]),_:2},1032,["onClick"]),[[h,i(c).userPermissionGet("Delete Team")]])])):(x(),$("div",ce,u(n.value),1))]),_:2},1032,["props"])]),pagination:l(()=>[v(u(i(t)("total"))+u(V.value)+" "+u(i(t)("page"))+" ",1),s(te,{modelValue:f.value.page,"onUpdate:modelValue":[e[5]||(e[5]=n=>f.value.page=n),e[6]||(e[6]=n=>r())],max:V.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},xe={__name:"TeamReader",setup(I){const t=q(),a=d(!1),c=d(""),P=d(""),C=d("");return R(()=>({title:c.value,meta:{description:{name:"description",content:P.value},keywords:{name:"keywords",content:C.value}}})),A(()=>{}),W(()=>{}),G(()=>t.dark.isActive,_=>{a.value=_}),(_,S)=>(x(),X(M,{class:"flex flex-top"},{default:l(()=>[s(ue)]),_:1}))}};export{xe as default};
