import{Q as F}from"./QPage-DjgmKzZ_.js";import{u as M}from"./use-meta-Drr87NGw.js";import{u as A}from"./use-quasar-CxlsMA-r.js";import{u as R,Q as y}from"./QItemLabel-BRceraJL.js";import{Z as E,a as $,r as c,o as I,w as S,a2 as G,a3 as P,a6 as o,a7 as l,a8 as g,ad as m,a5 as i,K as h,a9 as v,a4 as w,av as j,aK as H,ag as W,aq as Z,e as J,ab as X}from"./index-D6xcdmSy.js";import{a as Y,b as ee}from"./rtl-BJcSdsPV.js";import{Q as te,a as ae,b as ne}from"./QTable-mJIsuc0j.js";import{e as se,g as oe,p as C}from"./axios-B_9szzRp.js";import{u as ie}from"./language-BmNUDO97.js";import{u as le}from"./vue-i18n.runtime-BS3IaizX.js";const re=E("permission",{state:()=>({permission:[]}),getters:{permissionGet(k){return k.permission}},actions:{permissionChange(k){this.permission=k}},persist:{enable:!0}}),ce={class:"q-pa-md"},de={key:0},me={key:1},ue={__name:"TeamList",setup(k){const{t}=le(),a=A(),d=R(),T=ie(),_=re(),b=$(()=>[{name:"name",required:!0,label:t("team.name"),align:"left",field:"name"},{name:"created_time",label:t("created_time"),field:"created_time"},{name:"updated_time",label:t("updated_time"),field:"updated_time"},{name:"action",label:t("action"),align:"right"}]),V=$(()=>d.token),p=c([]),x=c(""),Q=c(0),f=c({sortBy:"updated_time",descending:!1,page:1,rowsPerPage:30,rowsNumber:30}),q=$(()=>V.value!==""?Math.ceil(Q.value/f.value.rowsPerPage):0),z=c(`${a.screen.height*.73}px`),L=c(`${a.screen.width*.825}px`),B=c(a.dark.isActive?"#121212":"#ffffff");function r(s){let e={};s?e=s:e.pagination=f.value,d.userPermissionGet("Get Team List")&&(oe({url:"core/team/",params:{search:x.value,page:e.pagination.page,max_page:e.pagination.rowsPerPage}}).then(n=>{p.value=n.results,Q.value=n.count,_.permissionChange(n.permission_list)}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()}),f.value=e.pagination)}function O(){a.dialog({dark:a.dark.isActive,title:t("team.new"),message:t("team.create"),prompt:{model:"",isValid:s=>s.length>2,type:"text"},cancel:!0}).onOk(async s=>{await C("core/team/create/",{name:s}).then(()=>{r()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}function D(s){a.dialog({dark:a.dark.isActive,title:t("team.change"),message:t("team.changeteam"),prompt:{model:"",isValid:e=>e.length>2,type:"text"},cancel:!0}).onOk(async e=>{await C("core/team/change/",{id:p.value[s].id,name:e}).then(()=>{r()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function U(s){a.dialog({title:t("team.permission"),message:t("team.choosepermission"),options:{type:"checkbox",model:Object.keys(p.value[s].permission),inline:!0,items:_.permissionGet},cancel:!0}).onOk(async e=>{await C("core/team/setpermission/",{id:p.value[s].id,permission:e}).then(()=>{r()}).catch(n=>{a.notify({type:"error",message:n}),a.loading.hide()})})}function K(s){a.dialog({dark:a.dark.isActive,title:t("team.delete"),message:t("confirmnotice"),cancel:!0}).onOk(async()=>{await C("core/team/delete/",{id:p.value[s].id}).then(()=>{r()}).catch(e=>{a.notify({type:"error",message:e}),a.loading.hide()})})}I(()=>{N(),r()}),S(()=>a.dark.isActive,s=>{B.value=s?"#121212":"#ffffff"});function N(){se.on("needLogin",s=>{s&&(p.value=[],x.value="",Q.value=0)})}return S(()=>T.langData,s=>{s&&r()}),(s,e)=>(P(),G("div",ce,[o(ne,{class:Z(i(a).dark.isActive?"my-sticky-header-last-column-table-dark":"my-sticky-header-last-column-table"),flat:"",bordered:"",rows:p.value,columns:b.value,"row-key":"index",pagination:f.value,"onUpdate:pagination":e[7]||(e[7]=n=>f.value=n),separator:"cell","no-data-label":i(t)("nodata"),"rows-per-page-label":i(t)("per_page"),"rows-per-page-options":[1,30,50,200,1e3],"table-style":{height:z.value,width:L.value},"card-style":{backgroundColor:B.value},onRequest:r},{top:l(n=>[o(Y,{flat:""},{default:l(()=>[h(o(v,{label:i(t)("refresh"),icon:"refresh",onClick:e[0]||(e[0]=u=>r())},{default:l(()=>[o(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(m(i(t)("refreshdata")),1)]),_:1})]),_:1},8,["label"]),[[w,i(d).userPermissionGet("Get User List")]]),h(o(v,{label:i(t)("new"),icon:"add",onClick:e[1]||(e[1]=u=>O())},{default:l(()=>[o(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(m(i(t)("team.new")),1)]),_:1})]),_:1},8,["label"]),[[w,i(d).userPermissionGet("Create One Team")]])]),_:1}),o(ee),o(j,{dense:"",debounce:"300",color:"primary",modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=u=>x.value=u),onInput:e[3]||(e[3]=u=>r()),onKeyup:e[4]||(e[4]=H(u=>r(),["enter"]))},{append:l(()=>[o(W,{name:"search"})]),_:1},8,["modelValue"]),o(v,{flat:"",round:"",dense:"",icon:n.inFullscreen?"fullscreen_exit":"fullscreen",onClick:n.toggleFullscreen},null,8,["icon","onClick"])]),"body-cell":l(n=>[o(ae,{props:n},{default:l(()=>[n.col.name==="action"?(P(),G("div",de,[h(o(v,{round:"",flat:"",icon:"edit",onClick:u=>D(n.rowIndex)},{default:l(()=>[o(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(m(i(t)("team.change")),1)]),_:1})]),_:2},1032,["onClick"]),[[w,i(d).userPermissionGet("Change Team")]]),h(o(v,{round:"",flat:"",icon:"admin_panel_settings",onClick:u=>U(n.rowIndex)},{default:l(()=>[o(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(m(i(t)("team.permission")),1)]),_:1})]),_:2},1032,["onClick"]),[[w,i(d).userPermissionGet("Set Permission For Team")]]),h(o(v,{round:"",flat:"",icon:"delete_sweep",onClick:u=>K(n.rowIndex)},{default:l(()=>[o(y,{class:"bg-indigo",offset:[10,10],"content-style":"font-size: 12px"},{default:l(()=>[g(m(i(t)("team.delete")),1)]),_:1})]),_:2},1032,["onClick"]),[[w,i(d).userPermissionGet("Delete Team")]])])):(P(),G("div",me,m(n.value),1))]),_:2},1032,["props"])]),pagination:l(()=>[g(m(i(t)("total"))+m(q.value)+" "+m(i(t)("page"))+" ",1),o(te,{modelValue:f.value.page,"onUpdate:modelValue":[e[5]||(e[5]=n=>f.value.page=n),e[6]||(e[6]=n=>r())],max:q.value,input:"","input-class":"text-orange-10"},null,8,["modelValue","max"])]),_:1},8,["class","rows","columns","pagination","no-data-label","rows-per-page-label","table-style","card-style"])]))}},xe={__name:"TeamReader",setup(k){const t=A(),a=c(!1),d=c(""),T=c(""),_=c("");return M(()=>({title:d.value,meta:{description:{name:"description",content:T.value},keywords:{name:"keywords",content:_.value}}})),I(()=>{}),J(()=>{}),S(()=>t.dark.isActive,b=>{a.value=b}),(b,V)=>(P(),X(F,{class:"flex flex-top"},{default:l(()=>[o(ue)]),_:1}))}};export{xe as default};
